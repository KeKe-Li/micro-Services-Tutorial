### micro-Services-Tutorial


#### promethues和grafana监控

在使用微服务架构的时候，需要链路监控，可视化和仪表盘显示，方便开发工程师查看到微服务中的组件和服务。可视化的dashboar可以用promethues和grafana结合一起使用显示。用promethues进行收集数据，grafana 进行数据的展示.
<p align="center">
<img width="100%" align="center" src="../images/1.jpg" />
</p>

prometheus的特点主要包括：

* 多维数据模型（时序列数据由metric名和一组key/value组成）.
* 在多维度上灵活的查询语言(PromQl).
* 不依赖分布式存储，单主节点工作.
* 通过基于HTTP的pull方式采集时序数据.
* 可以通过中间网关进行时序列数据推送(pushing).
* 目标服务器可以通过发现服务或者静态配置实现.
* 多种可视化和仪表盘支持.

promethues和grafana监控整个系统使用了三个组件：

* node-exporter：运行在主机上收集操作系统上各种数据的 agent，promethues 中称为 exporter.
* prometheus：开源的时序数据库，作为数据存储和分析的中心.
* grafana：数据展示分析界面，提供各种强大的 dashboard，可以从多个数据源读取数据，其中就包括 promethues.

prometheus的架构和部署

我们创建一个 docker-compose.yml 文件，里面只包含 promethues 一个服务：
```docker-compose
version: '2'
services:
  prometheus:
    image: prom/prometheus:v2.0.0
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
    ports:
      - '9090:9090'
```

